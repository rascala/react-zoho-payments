function zpayments(config) {
	const { wrapperRef, backdropRef, spinnerRef } = config;
	function _extends() {
		return (
			(_extends =
				Object.assign ||
				((e) => {
					for (let t = 1; t < arguments.length; t++) {
						const n = arguments[t];
						for (const r in n) {
							Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]);
						}
					}
					return e;
				})),
			_extends.apply(this, arguments)
		);
	}
	function _setPrototypeOf(e, t) {
		return (
			(_setPrototypeOf =
				Object.setPrototypeOf || ((e, t) => ((e.__proto__ = t), e))),
			_setPrototypeOf(e, t)
		);
	}
	function _isNativeReflectConstruct() {
		if (typeof Reflect === "undefined" || !Reflect.construct) {
			return !1;
		}
		if (Reflect.construct.sham) {
			return !1;
		}
		if (typeof Proxy === "function") {
			return !0;
		}
		try {
			return (
				Boolean.prototype.valueOf.call(
					Reflect.construct(Boolean, [], () => {}),
				),
				!0
			);
		} catch (e) {
			return !1;
		}
	}
	function _construct(_e, _t, _n) {
		return (
			(_construct = _isNativeReflectConstruct()
				? Reflect.construct
				: (e, t, n) => {
						const r = [null];
						r.push.apply(r, t);
						const o = new (Function.bind.apply(e, r))();
						return n && _setPrototypeOf(o, n.prototype), o;
					}),
			_construct.apply(null, arguments)
		);
	}
	let id = 0;
	function _classPrivateFieldLooseKey(e) {
		return `__private_${id++}_${e}`;
	}
	function _classPrivateFieldLooseBase(e, t) {
		if (!Object.prototype.hasOwnProperty.call(e, t)) {
			throw new TypeError("attempted to use private field on non-instance");
		}
		return e;
	}
	function isFunction(e) {
		return e && typeof e === "function";
	}
	const maxZIndex = "2147483647";
	const Dom = (() => {
		function e() {
			this.wrapperElement = loadContainer();
		}
		const t = e.prototype;
		return (
			(t.loadWidgetFrame = function (e, t) {
				void 0 === t && (t = {});
				const n = t.rootElement;
				const r = t.onLoad;
				const o = t.onError;
				const i = t.title;
				const s = void 0 === i ? "" : i;
				const a = document.createElement("iframe");
				return (
					a.setAttribute("src", e),
					a.setAttribute("title", s),
					a.setAttribute("frameborder", "0"),
					isFunction(r) && (a.onload = r),
					isFunction(o) && (a.onerror = o),
					n?.appendChild(a),
					(this.frameElement = a),
					a
				);
			}),
			(t.showWidgetFrame = function () {
				this.frameElement &&
					((document.body.style.overflow = "hidden"),
					(this.frameElement.style.cssText = `\n        position: fixed;\n        display: block;\n        top: 0; \n        left: 0; \n        height: 100%; \n        width: 100%; \n        z-index: ${maxZIndex} !important;\n      `));
			}),
			(t.hideWidgetFrame = function () {
				this.frameElement &&
					((document.body.style.overflow = "visible"),
					(this.frameElement.style.cssText = "display: none"));
			}),
			(t.loadBackdrop = function () {
				document.getElementById("zpay-backdrop") ||
					((this.bdElement = getBackdrop()),
					this.wrapperElement.appendChild(this.bdElement));
			}),
			(t.removeBackdrop = function () {
				let e;
				(e = this.bdElement) == null || e.remove();
			}),
			(t.loadSpinner = function () {
				(this.spinnerElement = getSpinner()),
					this.wrapperElement.appendChild(this.spinnerElement);
			}),
			(t.removeSpinner = function () {
				let e;
				(e = this.spinnerElement) == null || e.remove();
			}),
			e
		);
	})();
	function getBackdrop() {
		const e = backdropRef; // document.createElement("DIV");
		// return e.id = "zpay-backdrop",
		// return e.style.cssText = "\n    position: fixed; \n    top: 0; \n    left: 0; \n    height: 100%; \n    width: 100%; \n    background: #040a22; \n    opacity: 0;\n    transition: opacity 200ms ease-in;\n    z-index: " + (MAX_Z_INDEX - 1) + " !important;\n  ",
		return (
			setTimeout(() => {
				e.style.opacity = "0.5";
			}, 0),
			e
		);
	}
	function getSpinner() {
		const e = spinnerRef; // document.createElement("DIV");
		// return e.id = "zpay-spinner",
		// return e.style.cssText = "\n    position: fixed;\n    top: 25%;\n    left: 50%;\n    padding: 10px;\n    width: 52px;\n    height: 52px;\n    border-radius: 50%;\n    background-color: white;\n    opacity: 0;\n    transition: opacity 300ms ease-in;\n    z-index: " + MAX_Z_INDEX + " !important;\n    transform: translateX(-50%)\n  ",
		return (
			setTimeout(() => {
				e.style.opacity = "1";
			}, 0),
			(e.innerHTML =
				'\n    <style>\n      @keyframes zspin {\n        0% {\n          transform: rotate(0deg);\n        }\n        100% {\n          transform: rotate(360deg);\n        }\n      }\n\n      .zpayments-loader-icon {\n        height: 32px;\n        width: 32px;\n        animation: zspin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n      }\n    </style>\n\n    <svg viewBox="0 0 512 512" class="zpayments-loader-icon">\n      <g>\n        <path d="M255.52.19c-141.39,0-256,114.62-256,256s114.63,256,256,256,256-114.63,256-256S396.92.19,255.52.19Zm0,56.89c110,0,199.13,89.16,199.13,199.13S365.5,455.34,255.52,455.34,56.4,366.19,56.4,256.21,145.55,57.08,255.52,57.08Z" fill="#ededf0"/>\n        <path d="M255.52.19a256,256,0,0,1,233.4,150.64,28.45,28.45,0,0,1-51.84,23.44A199.18,199.18,0,0,0,255.52,57.08a28.45,28.45,0,0,1,0-56.89Z" fill="#1e93ff"/>\n      </g>\n    </svg>\n  '),
			e
		);
	}
	function loadContainer() {
		const e = wrapperRef; // document.createElement("DIV");
		// return e.id = "zpay-wrapper", document.body.prepend(e), e
		return e;
	}
	function getOrigin(e) {
		try {
			return new URL(e).origin;
		} catch (e) {}
		return e;
	}
	const closeAction = "close";
	const chargeAction = "charge";
	const openAction = "open";
	const widgetBootedAction = "widget_booted";
	const widgetBootFailed = "widget_boot_failed";
	const needsScaAction = "needs_sca";
	const scaSuccessAction = "sca_success";
	const scaFailureAction = "sca_failure";
	const getFinancialConnectionsAccounts = "get_financial_connections_accounts";
	const sendFinancialConnectionsAccounts =
		"send_financial_connections_accounts";
	const settingsModuleChangeAction = "settings:module-change";
	const chargeValidationError = "charge:validationerror";
	const threedsFailureAction = "charge:threedserror";
	const apiVersion = "api/v1";
	function getCookie(e) {
		for (
			let t = `${e}=`,
				n = decodeURIComponent(document.cookie).split(";"),
				r = 0;
			r < n.length;
			r++
		) {
			for (let o = n[r]; o.charAt(0) === " "; ) {
				o = o.substring(1);
			}
			if (o.indexOf(t) === 0) {
				return o.substring(t.length, o.length);
			}
		}
		return "";
	}
	function encode(e) {
		const t = [];
		for (const n in e) {
			const r = e[n];
			if (r) {
				const o = encodeURIComponent(n);
				const i = encodeURIComponent(r);
				t.push(`${o}=${i}`);
			}
		}
		return t.join("&");
	}
	const urlQuerySplitRegex = /\?(.+)/;
	function constructUrlWithParams(e, t) {
		void 0 === e && (e = ""), void 0 === t && (t = {});
		const n = extractParamsFromURL(e);
		const r = e.split(urlQuerySplitRegex);
		if (((e = r[0]), (t = _extends({}, n, t)), Object.keys(t).length)) {
			const o = encode(t);
			if (o) {
				return `${e}?${o}`;
			}
		}
		return e;
	}
	function extractParamsFromURL(e) {
		let t = "";
		try {
			t = new URL(e).search;
		} catch (r) {
			try {
				t = new URL(e, window.location.origin).search;
			} catch (e) {
				let n;
				return (
					((n = window.ZP_META) == null ? void 0 : n.is_development_or_local) &&
						console.error(e),
					{}
				);
			}
		}
		if (t) {
			const r = t.split(urlQuerySplitRegex)[1].split("&");
			const o = {};
			return (
				r.forEach((e) => {
					const t = e.split("=");
					const n = t[0];
					const r = t[1];
					o[void 0 === n ? "" : n] = decodeURIComponent(void 0 === r ? "" : r);
				}),
				o
			);
		}
		return {};
	}
	function validateAndAppendFrameOrigin(e) {
		let t;
		void 0 === e && (e = "");
		const n = window.location.origin;
		return (t = e) != null && t.includes(n)
			? e
			: [e, n].filter(Boolean).join(",");
	}
	const makeRequest1 = (e, t) => {
		void 0 === t && (t = {});
		try {
			const n = window.ZP_META || {};
			const r = n.account_id;
			const o = n.merchant_onboarding;
			const i =
				t.account_id ||
				(void 0 === r ? "" : r) ||
				(void 0 === o ? {} : o).account_id ||
				"";
			const s = /^https?:\/\//i.test(e);
			if (!s) {
				e = `${location.origin}/${apiVersion}${e}`;
				const a = {};
				i && (a.account_id = i),
					(e = constructUrlWithParams(e, a)),
					(t.headers = {
						"Content-Type": "application/json",
						"X-ZP-SOURCE": "zpclient",
						"X-ZOHO-Include-Formatted": !0,
					});
				const c = getCookie("zpcscook");
				c && (t.headers["X-ZCSRF-TOKEN"] = `zpcsparam=${c}`);
				const d = t.body;
				d instanceof FormData
					? (t.headers["Content-Type"] = undefined)
					: typeof d === "string" || s || (t.body = JSON.stringify(d));
			}
			return (
				(t.credentials = "same-origin"),
				Promise.resolve(window.fetch(e, t)).then((e) =>
					Promise.resolve(e.json()).then((t) => {
						if (e.ok) {
							return t;
						}
						throw t;
					}),
				)
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	function maskUrl(e) {
		try {
			return e.replace(
				/\b\d{4}\.[a-zA-Z0-9]{32}\.[a-zA-Z0-9]{32}\b/g,
				"REDACTED",
			);
		} catch (t) {
			return e;
		}
	}
	const uploadErrors = (e) => {
		void 0 === e && (e = {});
		try {
			let t;
			const n = {
				body: constructPayload(e),
				method: "POST",
				account_id:
					e.accountId ||
					((t = window.ZP_META) == null ? void 0 : t.account_id) ||
					"",
			};
			return Promise.resolve(makeRequest1("/errors", n)).then(() => {});
		} catch (e) {
			return Promise.reject(e);
		}
	};
	function constructPayload(e) {
		const t = window;
		let n = t.ZP_META;
		const r = (n = void 0 === n ? {} : n).build_version;
		const o = void 0 === r ? "" : r;
		const i = t.navigator;
		const s = void 0 === i ? {} : i;
		const a = t.location;
		const c = e.stack;
		const d = void 0 === c ? "" : c;
		const u = e.message;
		const l = void 0 === u ? "" : u;
		const h = e.identifier;
		const f = void 0 === h ? "" : h;
		const _ = e.serviceName;
		const m = void 0 === _ ? "Preact Apps" : _;
		const v = e.level;
		const p = void 0 === v ? "high" : v;
		const g = e.previous_routes;
		const E = e.url;
		return _extends(
			{
				url: void 0 === E ? maskUrl((void 0 === a ? {} : a).href) : E,
				browser: s.userAgent,
				build_label: o,
				service_name: m,
				message: l,
				level: p,
				previous_routes: g,
			},
			d && { trace: btoa(d) },
			f && { identifier: f },
		);
	}
	function logger() {
		const e = [
			"%cZohoPay Instance",
			"background-color: blue; color: white; border-radius:10px; padding: 0 6px;",
		];
		const t = window.ZP_META?.is_development_or_local;
		const n = void 0 !== t && t;
		return {
			log: () => {
				let t;
				n && (t = console).log.apply(t, e.concat([].slice.call(arguments)));
			},
			error: () => {
				let t;
				n && (t = console).error.apply(t, e.concat([].slice.call(arguments)));
			},
			warn: () => {
				let t;
				n && (t = console).warn.apply(t, e.concat([].slice.call(arguments)));
			},
			uploadError: () => {
				let t;
				const r = [].slice.call(arguments);
				const o = r[0].message;
				uploadErrors.apply(void 0, r),
					n && (t = console).error.apply(t, e.concat([o]));
			},
		};
	}
	const logger1 = logger();
	const Bus = (() => {
		function e(e) {
			const n = e.src;
			const r = e.targetWindow;
			if (
				((this.listeners = {}),
				(this.messageListener = (e) => {
					if (e.origin === this.allowedOrigin) {
						const n = e.data || {};
						const r = this.listeners[n.action];
						return r ? r(n.payload) : void 0;
					}
				}),
				r?.postMessage)
			) {
				return (
					this.addAllowedSites(n, r),
					void window.addEventListener("message", this.messageListener)
				);
			}
			throw "Can`t enable cross-origin communication. This may happen when you are passing an invalid targetWindow during instantiation";
		}
		const t = e.prototype;
		return (
			(t.addAllowedSites = function (e, t) {
				const n = getOrigin(e);
				(this.allowedOrigin = n), (this.targetWindow = t);
			}),
			(t.on = function (e, t) {
				if (!e) {
					throw "Event name is mandatory to register a event on the communication bus";
				}
				if (!t) {
					throw `Event handler is mandatory to register a event on the communication bus (Event: ${e})`;
				}
				this.listeners[e] &&
					logger1.log(
						`A handler is already registered for the event, "${e}". Hence old handler will be overridden by the current one.`,
					),
					(this.listeners[e] = t);
			}),
			(t.send = function (e) {
				this.targetWindow.postMessage(e, "*");
			}),
			(t.destroy = function () {
				window.removeEventListener("message", this.messageListener);
			}),
			e
		);
	})();
	const _getUrl1 = _classPrivateFieldLooseKey("getUrl");
	const Onboarding = (() => {
		function e(e) {
			Object.defineProperty(this, _getUrl1, { value: _getUrl21 }),
				(this.onboardingFrameElement = null);
			const t = e || {};
			const n = t.frameorigin;
			const r = void 0 === n ? "" : n;
			const o = t.baseUrl;
			(this.dom = t.domHandler), (this.frameorigin = r), (this.baseUrl = o);
		}
		const t = e.prototype;
		return (
			(t.open = function (e) {
				void 0 === e && (e = {});
				let t = e.selector;
				if ((typeof t === "string" && (t = document.querySelector(t)), t)) {
					const n = _classPrivateFieldLooseBase(this, _getUrl1)[_getUrl1](e);
					const r = this.dom.loadWidgetFrame(n, {
						rootElement: t,
						title: "Zoho Payments Account Onboarding",
					});
					r.style.cssText =
						"\n        width: 100%;\n        height: 100%;\n        border: none;\n      ";
					const o = new Bus({
						src: r.src,
						targetWindow: r.contentWindow,
					});
					(this.bus = o), (this.onboardingFrameElement = r);
				}
			}),
			(t.on = function (e, t) {
				isFunction(t) && this.bus && this.bus.on(`onboarding:${e}`, t);
			}),
			(t.close = function () {
				let e;
				let t;
				this.bus && (this.bus.listeners = {}),
					(e = this.onboardingFrameElement) == null ||
						(t = e.parentNode) == null ||
						t.removeChild(this.onboardingFrameElement);
			}),
			(t.openInSameTab = function (e) {
				void 0 === e && (e = {}),
					this.openInTab(_extends({}, e, { target: "_self" }));
			}),
			(t.openInTab = function (e) {
				void 0 === e && (e = {});
				const t = e.account_id;
				const n = e.service_name;
				const r = e.target;
				const o = void 0 === r ? "_blank" : r;
				const i = _classPrivateFieldLooseBase(this, _getUrl1)[_getUrl1]({
					account_id: t,
					service_name: n,
				});
				window.open(i, o);
			}),
			e
		);
	})();
	function _getUrl21(e) {
		void 0 === e && (e = {});
		const t = window.location.host;
		const n = e.account_id;
		const r = void 0 === n ? "" : n;
		const o = e.service_name;
		const i = void 0 === o ? "" : o;
		const s = r ? `/${r}` : "";
		let a = `${this.baseUrl}/account/create${s}`;
		return (
			t.indexOf("csez.zohocorpin.com") > 0 &&
				(a = `https://pay.csez.zohocorpin.com/account/create${s}`),
			constructUrlWithParams(a, {
				service_name: i,
				frameorigin: validateAndAppendFrameOrigin(this.frameorigin),
			})
		);
	}
	function formatEventName(e) {
		return e ? `settings:${e}` : "";
	}
	const _getUrl = _classPrivateFieldLooseKey("getUrl");
	const Settings = (() => {
		function e(e) {
			Object.defineProperty(this, _getUrl, { value: _getUrl2 }),
				(this.settingsFrameElement = null);
			const t = e || {};
			const n = t.frameorigin;
			const r = void 0 === n ? "" : n;
			const o = t.baseUrl;
			(this.dom = t.domHandler), (this.frameorigin = r), (this.baseUrl = o);
		}
		const t = e.prototype;
		return (
			(t.open = function (e) {
				void 0 === e && (e = {});
				let n = e.selector;
				const r = e.module;
				const o = void 0 === r ? "" : r;
				const i = e.account_id;
				const s = void 0 === i ? "" : i;
				const a = e.service_name;
				const c = void 0 === a ? "" : a;
				if ((typeof n === "string" && (n = document.querySelector(n)), n)) {
					const d = _classPrivateFieldLooseBase(this, _getUrl)[_getUrl]({
						account_id: s,
						module: o,
						service_name: c,
					});
					const u = this.dom.loadWidgetFrame(d, {
						rootElement: n,
						title: "Zoho Payments Settings",
						onError: (e) => {
							let n;
							let r;
							(n = e),
								isFunction(
									(r = this.bus.listeners[formatEventName("error")]),
								) && r(n);
						},
					});
					u.style.cssText =
						"\n        width: 100%;\n        height: 100%;\n        border: none;\n      ";
					const l = new Bus({ src: u.src, targetWindow: u.contentWindow });
					(this.bus = l), (this.settingsFrameElement = u);
				}
			}),
			(t.on = function (e, t) {
				isFunction(t) && this.bus.on(formatEventName(e), t);
			}),
			(t.route = function (e) {
				this.bus.send({ action: settingsModuleChangeAction, payload: e });
			}),
			(t.close = function () {
				let e;
				let t;
				this.bus && (this.bus.listeners = {}),
					(e = this.settingsFrameElement) == null ||
						(t = e.parentNode) == null ||
						t.removeChild(this.settingsFrameElement);
			}),
			(t.openInSameTab = function (e) {
				void 0 === e && (e = {}),
					this.openInTab(_extends({}, e, { target: "_self" }));
			}),
			(t.openInTab = function (e) {
				void 0 === e && (e = {});
				const t = e.account_id;
				const n = e.module;
				const r = e.service_name;
				const o = e.target;
				const i = void 0 === o ? "_blank" : o;
				const s = _classPrivateFieldLooseBase(this, _getUrl)[_getUrl]({
					account_id: t,
					module: n,
					service_name: r,
				});
				window.open(s, i);
			}),
			e
		);
	})();
	function _getUrl2(e) {
		let t;
		const n = e.module;
		const r = e.service_name;
		const o =
			e.account_id || ((t = window.ZP_META) == null ? void 0 : t.account_id);
		let i = "";
		return (
			(i = `/settings${o ? `/${o}` : ""}`),
			this.baseUrl && (i = this.baseUrl + i),
			constructUrlWithParams(i, {
				module: void 0 === n ? "" : n,
				service_name: void 0 === r ? "" : r,
				frameorigin: validateAndAppendFrameOrigin(this.frameorigin),
			})
		);
	}
	function filterOptions(e) {
		const t = {};
		return (
			Object.keys(e).forEach((n) => {
				const r = e[n];
				typeof r !== "function" && (t[n] = r);
			}),
			t
		);
	}
	function appendAccIdForIframeUrl(e, t) {
		const n = e.split("?");
		let r = n[0];
		const o = n[1];
		const i = void 0 === o ? "" : o;
		return (r = t ? `${r}/${t}` : r), i ? `${r}?${i}` : r;
	}
	const widgetClosed = {
		code: "widget_closed",
		message: "Checkout widget closed by user",
	};
	const widgetLoadParamsMissing = {
		code: "inadequate_params_to_load_widget",
		message: "Required params to load the widget are not found!",
	};
	const widgetFailedToLoad = {
		code: "widget_failed_to_load",
		message:
			"Something went wrong and it looks like a temporary glitch. Please try again in some time.",
	};
	const widgetValidationError = {
		code: "widget_validation_error",
		message:
			"Something went wrong and it looks like a temporary glitch. Please try again in some time.",
	};
	const achWidgetClosedError = {
		code: "ach_widget_validation_error",
		message:
			"Payment could not be processed as the session was terminated. You can try initiating the payment again.",
	};
	function isEmptyObj(e) {
		return (
			!e || Object.keys(e).every((t) => Object.keys(e[t] || {}).length === 0)
		);
	}
	let chargeFrameUrl = "";
	const ChargeWidget = (() => {
		function e(e) {
			(this._removeWidgetLoadingState = () => {
				(this.isLoading = !1), this.dom.removeSpinner();
			}),
				(this._handleWidgetBootFailure = () => {
					this.dom.removeBackdrop(),
						this._removeWidgetLoadingState(),
						(this.isBootFailure = !0);
				}),
				(this._handleClose = () => {
					this.close();
				});
			const n = e || {};
			const r = n.domHandler;
			const o = n.accountId;
			const i = void 0 === o ? "" : o;
			const s = n.frameorigin;
			const a = void 0 === s ? "" : s;
			const c = n.baseUrl;
			const d = n.otherOptions;
			const u = void 0 === d ? {} : d;
			const l = n.edition;
			const h = void 0 === l ? "US" : l;
			(this.trackerInfo = u.tracker),
				(this.environment = u.__environment),
				(this.dom = r),
				(this.frameorigin = a),
				(this.baseUrl = c),
				this._getWidgetBaseUrl(),
				(this.edition = h),
				(this.accountId = i),
				(this.zApiKey = u.zApiKey || u.api_key),
				(this.isLoading = !0);
			const f = this._loadChargeFrame(i);
			(this.bus = new Bus({ src: f.src, targetWindow: f.contentWindow })),
				this.bus.on(widgetBootedAction, this._removeWidgetLoadingState),
				this.bus.on(widgetBootFailed, this._handleWidgetBootFailure);
		}
		const t = e.prototype;
		return (
			(t.requestPaymentMethod = function (e) {
				const n = e.tracker;
				const r = void 0 === n ? {} : n;
				return new Promise((n, o) => {
					if (this.edition !== "IN" || (this.accountId && this.zApiKey)) {
						const i = this.isLoading;
						const s = this.isBootFailure;
						return (
							this.bus.on(closeAction, () => {
								this._handleClose(), o(widgetClosed);
							}),
							this.dom.loadBackdrop(),
							r.source_url || (r.source_url = location.href || ""),
							isEmptyObj(r) ||
								(this.trackerInfo = _extends({}, this.trackerInfo, r)),
							(this.paymentOptions = _extends({}, e, {
								trackerInfo: this.trackerInfo,
								zApiKey: this.zApiKey,
								environment: this.environment,
							})),
							i
								? (logger1.log("Frame is still loading"),
									this.dom.loadSpinner(),
									this.bus.on(widgetBootedAction, () => {
										this._removeWidgetLoadingState(),
											this._requestPaymentMethod().then(n).catch(o);
									}),
									this.bus.on(widgetBootFailed, () => {
										this._handleWidgetBootFailure(), o(widgetFailedToLoad);
									}))
								: s && (this._handleWidgetBootFailure(), o(widgetFailedToLoad)),
							this._requestPaymentMethod().then(n).catch(o)
						);
					}
					o(widgetLoadParamsMissing);
				});
			}),
			(t.verifyPaymentMethod = function (e) {
				return (
					this.dom.showWidgetFrame(),
					new Promise((n, r) => {
						this.bus.send({
							action: needsScaAction,
							payload: e,
						}),
							this.bus.on(scaSuccessAction, (e) => {
								this._hideScaFrame(), n(e);
							}),
							this.bus.on(scaFailureAction, (e) => {
								this._hideScaFrame(), r(e);
							});
					})
				);
			}),
			(t.collectBankAccounts = function (e) {
				const n = e?.client_secret;
				const r = {
					clientSecret: void 0 === n ? "" : n,
				};
				return new Promise((e, n) => {
					this.bus.send({
						action: getFinancialConnectionsAccounts,
						payload: r,
					}),
						this.bus.on(sendFinancialConnectionsAccounts, (t) => {
							void 0 === t && (t = {}),
								Object.keys(t).length > 0 ? e(t) : n(achWidgetClosedError);
						});
				});
			}),
			(t.close = function () {
				this._closeWrapper(), this._closeForm(), (this.isFormVisible = !1);
			}),
			(t._hideScaFrame = function () {
				!this.isFormVisible && this.dom.hideWidgetFrame();
			}),
			(t._loadChargeFrame = function (e) {
				const t = extractParamsFromURL(chargeFrameUrl);
				const n = window.location.origin;
				(t.frameorigin = validateAndAppendFrameOrigin(this.frameorigin)),
					(t.host = n);
				const r = constructUrlWithParams(
					appendAccIdForIframeUrl(chargeFrameUrl, e),
					t,
				);
				const o = this.dom.loadWidgetFrame(r, {
					rootElement: this.dom.wrapperElement,
					title: "Checkout - Powered by Zoho Payments",
				});
				return (o.style.cssText = "display: none"), o;
			}),
			(t._requestPaymentMethod = function () {
				return new Promise((t, n) => {
					logger1.log("Opening the widget"),
						(this.isFormVisible = !0),
						this.dom.showWidgetFrame();
					const r = filterOptions(this.paymentOptions);
					this.bus.send({ action: openAction, payload: r }),
						this.bus.on(chargeValidationError, (e) => {
							n(e || widgetValidationError);
						}),
						this.bus.on(threedsFailureAction, (e) => {
							n(e);
						}),
						this.bus.on(chargeAction, (e) => {
							t(e);
						});
				});
			}),
			(t._closeWrapper = function () {
				logger1.log("Closing the widget"),
					this.dom.hideWidgetFrame(),
					this.dom.removeBackdrop(),
					this.dom.removeSpinner();
			}),
			(t._closeForm = function () {
				this.bus.send({ action: closeAction });
			}),
			(t._getWidgetBaseUrl = function () {
				chargeFrameUrl === "" && (chargeFrameUrl = `${this.baseUrl}/charge`);
			}),
			e
		);
	})();
	const envHash = {
		sandbox: {
			subdomain: "pay",
			domain: "localzoho",
			domainDc: "com",
		},
		pre: { subdomain: "prepay", domain: "zoho" },
		production: { subdomain: "payments", domain: "zoho" },
	};
	const dcHash = { US: "com", IN: "in" };
	const DCs = ["com", "in"];
	const environments = ["sandbox", "pre", "production"];
	function getWidgetBaseURL(e, t) {
		void 0 === t && (t = "production");
		const n = dcHash == null ? void 0 : dcHash[e];
		if (!DCs.includes(n)) {
			return (
				logger1.error(
					"Edition unavialble or incorrect, available editions US, IN.",
				),
				"https://payments.zoho.com"
			);
		}
		environments.includes(t) || (t = "production");
		const r = envHash[t];
		const o = r.subdomain;
		let i = void 0 === o ? "payments" : o;
		const s = r.domain;
		const a = r.domainDc;
		return (
			e !== "US" && t === "sandbox" && (i = `${i}-${n}`),
			n === "in" && t === "production" && (i = "payments"),
			`https://${i}.${void 0 === s ? "zoho" : s}.${void 0 === a ? dcHash[e] : a}`
		);
	}
	const makeRequest = (e, t) => {
		void 0 === t && (t = {});
		try {
			return (
				(t.credentials = "same-origin"),
				Promise.resolve(window.fetch(e, t)).then((e) =>
					Promise.resolve(e.json()).then((t) => {
						if (e.ok) {
							return t;
						}
						throw t;
					}),
				)
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	const makeEventRequest = (e, t, n) => {
		try {
			void 0 === t && (t = {});
			const r = new Date().getTime();
			return (
				(t = Object.assign(
					{},
					{
						timestamp: r,
					},
					t,
				)),
				(e = `${constructBaseUrl(n)}/tracker/${apiVersion}${e}`),
				Promise.resolve(
					makeRequest(e, {
						method: "POST",
						body: encode(t),
						headers: { "Content-Type": "application/x-www-form-urlencoded" },
						mode: "cors",
					}),
				)
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	function constructBaseUrl(e) {
		void 0 === e && (e = {});
		const t = e.edition;
		const n = e.environment;
		return getWidgetBaseURL(
			void 0 === t ? "US" : t,
			void 0 === n ? "production" : n,
		);
	}
	function _catch1(e, t) {
		try {
			const n = e();
		} catch (e) {
			return t(e);
		}
		return n?.then ? n.then(void 0, t) : n;
	}
	const sendEvent = (e, t, n, r) => {
		try {
			const o = {
				event_type: e,
				session_id: n.sessionId,
				account_id: n.accountId,
				timestamp: Date.now(),
				data: btoa(JSON.stringify(t)),
			};
			return Promise.resolve(
				_catch1(
					() =>
						Promise.resolve(makeEventRequest("/event", o, r)).then(() => {}),
					(t) => {
						throw (
							(logger1.error("Error while sending event: ", e, t.message || t),
							t)
						);
					},
				),
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	const commonjsGlobal =
		typeof globalThis !== "undefined"
			? globalThis
			: typeof window !== "undefined"
				? window
				: typeof global !== "undefined"
					? global
					: typeof self !== "undefined"
						? self
						: {};
	function createCommonjsModule(e) {
		const t = { exports: {} };
		return e(t, t.exports), t.exports;
	}
	const md5 = createCommonjsModule((module) => {
		(() => {
			const error = "input is invalid type";
			let window = typeof window === "object";
			let root = window ? window : {};
			root.JS_MD5_NO_WINDOW && (window = !1);
			const webWorker = !window && typeof self === "object";
			const nodeJs =
				!root.JS_MD5_NO_NODE_JS &&
				typeof process === "object" &&
				process.versions &&
				process.versions.node;
			nodeJs ? (root = commonjsGlobal) : webWorker && (root = self);
			const commonJs = !root.JS_MD5_NO_COMMON_JS && module.exports;
			const arrayBuffer =
				!root.JS_MD5_NO_ARRAY_BUFFER && typeof ArrayBuffer !== "undefined";
			const hexChars = "0123456789abcdef".split("");
			const extra = [128, 32768, 8388608, -2147483648];
			const shift = [0, 8, 16, 24];
			const outputTypes = [
				"hex",
				"array",
				"digest",
				"buffer",
				"arrayBuffer",
				"base64",
			];
			const base64EncodeChar =
				"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(
					"",
				);
			let blocks = [];
			let buffer8;
			if (arrayBuffer) {
				const buffer = new ArrayBuffer(68);
				(buffer8 = new Uint8Array(buffer)), (blocks = new Uint32Array(buffer));
			}
			(!root.JS_MD5_NO_NODE_JS && Array.isArray) ||
				(Array.isArray = (e) =>
					Object.prototype.toString.call(e) === "[object Array]"),
				!arrayBuffer ||
					(!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW && ArrayBuffer.isView) ||
					(ArrayBuffer.isView = (e) =>
						typeof e === "object" &&
						e.buffer &&
						e.buffer.constructor === ArrayBuffer);
			const createOutputMethod = (e) => (t) => new Md5(!0).update(t)[e]();
			const createMethod = () => {
				let e = createOutputMethod("hex");
				nodeJs && (e = nodeWrap(e)),
					(e.create = () => new Md5()),
					(e.update = (t) => e.create().update(t));
				for (let t = 0; t < outputTypes.length; ++t) {
					const n = outputTypes[t];
					e[n] = createOutputMethod(n);
				}
				return e;
			};
			const nodeWrap = function nodeWrap(method) {
				const crypto = eval("require('crypto')");
				const Buffer = eval("require('buffer').Buffer");
				const nodeMethod = (e) => {
					if (typeof e === "string") {
						return crypto.createHash("md5").update(e, "utf8").digest("hex");
					}
					if (e == null) {
						throw error;
					}
					return (
						e.constructor === ArrayBuffer && (e = new Uint8Array(e)),
						Array.isArray(e) ||
						ArrayBuffer.isView(e) ||
						e.constructor === Buffer
							? crypto.createHash("md5").update(new Buffer(e)).digest("hex")
							: method(e)
					);
				};
				return nodeMethod;
			};
			function Md5(e) {
				if (e) {
					(blocks[0] =
						blocks[16] =
						blocks[1] =
						blocks[2] =
						blocks[3] =
						blocks[4] =
						blocks[5] =
						blocks[6] =
						blocks[7] =
						blocks[8] =
						blocks[9] =
						blocks[10] =
						blocks[11] =
						blocks[12] =
						blocks[13] =
						blocks[14] =
						blocks[15] =
							0),
						(this.blocks = blocks),
						(this.buffer8 = buffer8);
				} else if (arrayBuffer) {
					const t = new ArrayBuffer(68);
					(this.buffer8 = new Uint8Array(t)),
						(this.blocks = new Uint32Array(t));
				} else {
					this.blocks = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
				}
				(this.h0 =
					this.h1 =
					this.h2 =
					this.h3 =
					this.start =
					this.bytes =
					this.hBytes =
						0),
					(this.finalized = this.hashed = !1),
					(this.first = !0);
			}
			(Md5.prototype.update = function (e) {
				if (!this.finalized) {
					let t;
					const n = typeof e;
					if (n !== "string") {
						if (n !== "object") {
							throw error;
						}
						if (e === null) {
							throw error;
						}
						if (arrayBuffer && e.constructor === ArrayBuffer) {
							e = new Uint8Array(e);
						} else if (
							!(Array.isArray(e) || (arrayBuffer && ArrayBuffer.isView(e)))
						) {
							throw error;
						}
						t = !0;
					}
					for (
						let r, o, i = 0, s = e.length, a = this.blocks, c = this.buffer8;
						i < s;
					) {
						if (
							(this.hashed &&
								((this.hashed = !1),
								(a[0] = a[16]),
								(a[16] =
									a[1] =
									a[2] =
									a[3] =
									a[4] =
									a[5] =
									a[6] =
									a[7] =
									a[8] =
									a[9] =
									a[10] =
									a[11] =
									a[12] =
									a[13] =
									a[14] =
									a[15] =
										0)),
							t)
						) {
							if (arrayBuffer) {
								for (o = this.start; i < s && o < 64; ++i) {
									c[o++] = e[i];
								}
							} else {
								for (o = this.start; i < s && o < 64; ++i) {
									a[o >> 2] |= e[i] << shift[3 & o++];
								}
							}
						} else if (arrayBuffer) {
							for (o = this.start; i < s && o < 64; ++i) {
								(r = e.charCodeAt(i)) < 128
									? (c[o++] = r)
									: r < 2048
										? ((c[o++] = 192 | (r >> 6)), (c[o++] = 128 | (63 & r)))
										: r < 55296 || r >= 57344
											? ((c[o++] = 224 | (r >> 12)),
												(c[o++] = 128 | ((r >> 6) & 63)),
												(c[o++] = 128 | (63 & r)))
											: ((r =
													65536 +
													(((1023 & r) << 10) | (1023 & e.charCodeAt(++i)))),
												(c[o++] = 240 | (r >> 18)),
												(c[o++] = 128 | ((r >> 12) & 63)),
												(c[o++] = 128 | ((r >> 6) & 63)),
												(c[o++] = 128 | (63 & r)));
							}
						} else {
							for (o = this.start; i < s && o < 64; ++i) {
								(r = e.charCodeAt(i)) < 128
									? (a[o >> 2] |= r << shift[3 & o++])
									: r < 2048
										? ((a[o >> 2] |= (192 | (r >> 6)) << shift[3 & o++]),
											(a[o >> 2] |= (128 | (63 & r)) << shift[3 & o++]))
										: r < 55296 || r >= 57344
											? ((a[o >> 2] |= (224 | (r >> 12)) << shift[3 & o++]),
												(a[o >> 2] |=
													(128 | ((r >> 6) & 63)) << shift[3 & o++]),
												(a[o >> 2] |= (128 | (63 & r)) << shift[3 & o++]))
											: ((r =
													65536 +
													(((1023 & r) << 10) | (1023 & e.charCodeAt(++i)))),
												(a[o >> 2] |= (240 | (r >> 18)) << shift[3 & o++]),
												(a[o >> 2] |=
													(128 | ((r >> 12) & 63)) << shift[3 & o++]),
												(a[o >> 2] |=
													(128 | ((r >> 6) & 63)) << shift[3 & o++]),
												(a[o >> 2] |= (128 | (63 & r)) << shift[3 & o++]));
							}
						}
						(this.lastByteIndex = o),
							(this.bytes += o - this.start),
							o >= 64
								? ((this.start = o - 64), this.hash(), (this.hashed = !0))
								: (this.start = o);
					}
					return (
						this.bytes > 4294967295 &&
							((this.hBytes += (this.bytes / 4294967296) << 0),
							(this.bytes %= 4294967296)),
						this
					);
				}
			}),
				(Md5.prototype.finalize = function () {
					if (!this.finalized) {
						this.finalized = !0;
						const e = this.blocks;
						const t = this.lastByteIndex;
						(e[t >> 2] |= extra[3 & t]),
							t >= 56 &&
								(this.hashed || this.hash(),
								(e[0] = e[16]),
								(e[16] =
									e[1] =
									e[2] =
									e[3] =
									e[4] =
									e[5] =
									e[6] =
									e[7] =
									e[8] =
									e[9] =
									e[10] =
									e[11] =
									e[12] =
									e[13] =
									e[14] =
									e[15] =
										0)),
							(e[14] = this.bytes << 3),
							(e[15] = (this.hBytes << 3) | (this.bytes >>> 29)),
							this.hash();
					}
				}),
				(Md5.prototype.hash = function () {
					let e;
					let t;
					let n;
					let r;
					let o;
					let i;
					const s = this.blocks;
					this.first
						? (t =
								((((t =
									((e =
										((((e = s[0] - 680876937) << 7) | (e >>> 25)) -
											271733879) <<
										0) ^
										((n =
											((((n =
												(-271733879 ^
													((r =
														((((r =
															(-1732584194 ^ (2004318071 & e)) +
															s[1] -
															117830708) <<
															12) |
															(r >>> 20)) +
															e) <<
														0) &
														(-271733879 ^ e))) +
												s[2] -
												1126478375) <<
												17) |
												(n >>> 15)) +
												r) <<
											0) &
											(r ^ e))) +
									s[3] -
									1316259209) <<
									22) |
									(t >>> 10)) +
									n) <<
								0)
						: ((e = this.h0),
							(t = this.h1),
							(t =
								((((t +=
									((e =
										((((e +=
											((r = this.h3) ^ (t & ((n = this.h2) ^ r))) +
											s[0] -
											680876936) <<
											7) |
											(e >>> 25)) +
											t) <<
										0) ^
										((n =
											((((n +=
												(t ^
													((r =
														((((r += (n ^ (e & (t ^ n))) + s[1] - 389564586) <<
															12) |
															(r >>> 20)) +
															e) <<
														0) &
														(e ^ t))) +
												s[2] +
												606105819) <<
												17) |
												(n >>> 15)) +
												r) <<
											0) &
											(r ^ e))) +
									s[3] -
									1044525330) <<
									22) |
									(t >>> 10)) +
									n) <<
								0)),
						(t =
							((((t +=
								((e =
									((((e += (r ^ (t & (n ^ r))) + s[4] - 176418897) << 7) |
										(e >>> 25)) +
										t) <<
									0) ^
									((n =
										((((n +=
											(t ^
												((r =
													((((r += (n ^ (e & (t ^ n))) + s[5] + 1200080426) <<
														12) |
														(r >>> 20)) +
														e) <<
													0) &
													(e ^ t))) +
											s[6] -
											1473231341) <<
											17) |
											(n >>> 15)) +
											r) <<
										0) &
										(r ^ e))) +
								s[7] -
								45705983) <<
								22) |
								(t >>> 10)) +
								n) <<
							0),
						(t =
							((((t +=
								((e =
									((((e += (r ^ (t & (n ^ r))) + s[8] + 1770035416) << 7) |
										(e >>> 25)) +
										t) <<
									0) ^
									((n =
										((((n +=
											(t ^
												((r =
													((((r += (n ^ (e & (t ^ n))) + s[9] - 1958414417) <<
														12) |
														(r >>> 20)) +
														e) <<
													0) &
													(e ^ t))) +
											s[10] -
											42063) <<
											17) |
											(n >>> 15)) +
											r) <<
										0) &
										(r ^ e))) +
								s[11] -
								1990404162) <<
								22) |
								(t >>> 10)) +
								n) <<
							0),
						(t =
							((((t +=
								((e =
									((((e += (r ^ (t & (n ^ r))) + s[12] + 1804603682) << 7) |
										(e >>> 25)) +
										t) <<
									0) ^
									((n =
										((((n +=
											(t ^
												((r =
													((((r += (n ^ (e & (t ^ n))) + s[13] - 40341101) <<
														12) |
														(r >>> 20)) +
														e) <<
													0) &
													(e ^ t))) +
											s[14] -
											1502002290) <<
											17) |
											(n >>> 15)) +
											r) <<
										0) &
										(r ^ e))) +
								s[15] +
								1236535329) <<
								22) |
								(t >>> 10)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											(n &
												((e =
													((((e += (n ^ (r & (t ^ n))) + s[1] - 165796510) <<
														5) |
														(e >>> 27)) +
														t) <<
													0) ^
													t))) +
										s[6] -
										1069501632) <<
										9) |
										(r >>> 23)) +
										e) <<
									0) ^
									(e &
										((n =
											((((n += (e ^ (t & (r ^ e))) + s[11] + 643717713) << 14) |
												(n >>> 18)) +
												r) <<
											0) ^
											r))) +
								s[0] -
								373897302) <<
								20) |
								(t >>> 12)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											(n &
												((e =
													((((e += (n ^ (r & (t ^ n))) + s[5] - 701558691) <<
														5) |
														(e >>> 27)) +
														t) <<
													0) ^
													t))) +
										s[10] +
										38016083) <<
										9) |
										(r >>> 23)) +
										e) <<
									0) ^
									(e &
										((n =
											((((n += (e ^ (t & (r ^ e))) + s[15] - 660478335) << 14) |
												(n >>> 18)) +
												r) <<
											0) ^
											r))) +
								s[4] -
								405537848) <<
								20) |
								(t >>> 12)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											(n &
												((e =
													((((e += (n ^ (r & (t ^ n))) + s[9] + 568446438) <<
														5) |
														(e >>> 27)) +
														t) <<
													0) ^
													t))) +
										s[14] -
										1019803690) <<
										9) |
										(r >>> 23)) +
										e) <<
									0) ^
									(e &
										((n =
											((((n += (e ^ (t & (r ^ e))) + s[3] - 187363961) << 14) |
												(n >>> 18)) +
												r) <<
											0) ^
											r))) +
								s[8] +
								1163531501) <<
								20) |
								(t >>> 12)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											(n &
												((e =
													((((e += (n ^ (r & (t ^ n))) + s[13] - 1444681467) <<
														5) |
														(e >>> 27)) +
														t) <<
													0) ^
													t))) +
										s[2] -
										51403784) <<
										9) |
										(r >>> 23)) +
										e) <<
									0) ^
									(e &
										((n =
											((((n += (e ^ (t & (r ^ e))) + s[7] + 1735328473) << 14) |
												(n >>> 18)) +
												r) <<
											0) ^
											r))) +
								s[12] -
								1926607734) <<
								20) |
								(t >>> 12)) +
								n) <<
							0),
						(t =
							((((t +=
								((i =
									(r =
										((((r +=
											((o = t ^ n) ^
												(e =
													((((e += (o ^ r) + s[5] - 378558) << 4) |
														(e >>> 28)) +
														t) <<
													0)) +
											s[8] -
											2022574463) <<
											11) |
											(r >>> 21)) +
											e) <<
										0) ^ e) ^
									(n =
										((((n += (i ^ t) + s[11] + 1839030562) << 16) |
											(n >>> 16)) +
											r) <<
										0)) +
								s[14] -
								35309556) <<
								23) |
								(t >>> 9)) +
								n) <<
							0),
						(t =
							((((t +=
								((i =
									(r =
										((((r +=
											((o = t ^ n) ^
												(e =
													((((e += (o ^ r) + s[1] - 1530992060) << 4) |
														(e >>> 28)) +
														t) <<
													0)) +
											s[4] +
											1272893353) <<
											11) |
											(r >>> 21)) +
											e) <<
										0) ^ e) ^
									(n =
										((((n += (i ^ t) + s[7] - 155497632) << 16) | (n >>> 16)) +
											r) <<
										0)) +
								s[10] -
								1094730640) <<
								23) |
								(t >>> 9)) +
								n) <<
							0),
						(t =
							((((t +=
								((i =
									(r =
										((((r +=
											((o = t ^ n) ^
												(e =
													((((e += (o ^ r) + s[13] + 681279174) << 4) |
														(e >>> 28)) +
														t) <<
													0)) +
											s[0] -
											358537222) <<
											11) |
											(r >>> 21)) +
											e) <<
										0) ^ e) ^
									(n =
										((((n += (i ^ t) + s[3] - 722521979) << 16) | (n >>> 16)) +
											r) <<
										0)) +
								s[6] +
								76029189) <<
								23) |
								(t >>> 9)) +
								n) <<
							0),
						(t =
							((((t +=
								((i =
									(r =
										((((r +=
											((o = t ^ n) ^
												(e =
													((((e += (o ^ r) + s[9] - 640364487) << 4) |
														(e >>> 28)) +
														t) <<
													0)) +
											s[12] -
											421815835) <<
											11) |
											(r >>> 21)) +
											e) <<
										0) ^ e) ^
									(n =
										((((n += (i ^ t) + s[15] + 530742520) << 16) | (n >>> 16)) +
											r) <<
										0)) +
								s[2] -
								995338651) <<
								23) |
								(t >>> 9)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											((e =
												((((e += (n ^ (t | ~r)) + s[0] - 198630844) << 6) |
													(e >>> 26)) +
													t) <<
												0) |
												~n)) +
										s[7] +
										1126891415) <<
										10) |
										(r >>> 22)) +
										e) <<
									0) ^
									((n =
										((((n += (e ^ (r | ~t)) + s[14] - 1416354905) << 15) |
											(n >>> 17)) +
											r) <<
										0) |
										~e)) +
								s[5] -
								57434055) <<
								21) |
								(t >>> 11)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											((e =
												((((e += (n ^ (t | ~r)) + s[12] + 1700485571) << 6) |
													(e >>> 26)) +
													t) <<
												0) |
												~n)) +
										s[3] -
										1894986606) <<
										10) |
										(r >>> 22)) +
										e) <<
									0) ^
									((n =
										((((n += (e ^ (r | ~t)) + s[10] - 1051523) << 15) |
											(n >>> 17)) +
											r) <<
										0) |
										~e)) +
								s[1] -
								2054922799) <<
								21) |
								(t >>> 11)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											((e =
												((((e += (n ^ (t | ~r)) + s[8] + 1873313359) << 6) |
													(e >>> 26)) +
													t) <<
												0) |
												~n)) +
										s[15] -
										30611744) <<
										10) |
										(r >>> 22)) +
										e) <<
									0) ^
									((n =
										((((n += (e ^ (r | ~t)) + s[6] - 1560198380) << 15) |
											(n >>> 17)) +
											r) <<
										0) |
										~e)) +
								s[13] +
								1309151649) <<
								21) |
								(t >>> 11)) +
								n) <<
							0),
						(t =
							((((t +=
								((r =
									((((r +=
										(t ^
											((e =
												((((e += (n ^ (t | ~r)) + s[4] - 145523070) << 6) |
													(e >>> 26)) +
													t) <<
												0) |
												~n)) +
										s[11] -
										1120210379) <<
										10) |
										(r >>> 22)) +
										e) <<
									0) ^
									((n =
										((((n += (e ^ (r | ~t)) + s[2] + 718787259) << 15) |
											(n >>> 17)) +
											r) <<
										0) |
										~e)) +
								s[9] -
								343485551) <<
								21) |
								(t >>> 11)) +
								n) <<
							0),
						this.first
							? ((this.h0 = (e + 1732584193) << 0),
								(this.h1 = (t - 271733879) << 0),
								(this.h2 = (n - 1732584194) << 0),
								(this.h3 = (r + 271733878) << 0),
								(this.first = !1))
							: ((this.h0 = (this.h0 + e) << 0),
								(this.h1 = (this.h1 + t) << 0),
								(this.h2 = (this.h2 + n) << 0),
								(this.h3 = (this.h3 + r) << 0));
				}),
				(Md5.prototype.hex = function () {
					this.finalize();
					const e = this.h0;
					const t = this.h1;
					const n = this.h2;
					const r = this.h3;
					return (
						hexChars[(e >> 4) & 15] +
						hexChars[15 & e] +
						hexChars[(e >> 12) & 15] +
						hexChars[(e >> 8) & 15] +
						hexChars[(e >> 20) & 15] +
						hexChars[(e >> 16) & 15] +
						hexChars[(e >> 28) & 15] +
						hexChars[(e >> 24) & 15] +
						hexChars[(t >> 4) & 15] +
						hexChars[15 & t] +
						hexChars[(t >> 12) & 15] +
						hexChars[(t >> 8) & 15] +
						hexChars[(t >> 20) & 15] +
						hexChars[(t >> 16) & 15] +
						hexChars[(t >> 28) & 15] +
						hexChars[(t >> 24) & 15] +
						hexChars[(n >> 4) & 15] +
						hexChars[15 & n] +
						hexChars[(n >> 12) & 15] +
						hexChars[(n >> 8) & 15] +
						hexChars[(n >> 20) & 15] +
						hexChars[(n >> 16) & 15] +
						hexChars[(n >> 28) & 15] +
						hexChars[(n >> 24) & 15] +
						hexChars[(r >> 4) & 15] +
						hexChars[15 & r] +
						hexChars[(r >> 12) & 15] +
						hexChars[(r >> 8) & 15] +
						hexChars[(r >> 20) & 15] +
						hexChars[(r >> 16) & 15] +
						hexChars[(r >> 28) & 15] +
						hexChars[(r >> 24) & 15]
					);
				}),
				(Md5.prototype.toString = Md5.prototype.hex),
				(Md5.prototype.digest = function () {
					this.finalize();
					const e = this.h0;
					const t = this.h1;
					const n = this.h2;
					const r = this.h3;
					return [
						255 & e,
						(e >> 8) & 255,
						(e >> 16) & 255,
						(e >> 24) & 255,
						255 & t,
						(t >> 8) & 255,
						(t >> 16) & 255,
						(t >> 24) & 255,
						255 & n,
						(n >> 8) & 255,
						(n >> 16) & 255,
						(n >> 24) & 255,
						255 & r,
						(r >> 8) & 255,
						(r >> 16) & 255,
						(r >> 24) & 255,
					];
				}),
				(Md5.prototype.array = Md5.prototype.digest),
				(Md5.prototype.arrayBuffer = function () {
					this.finalize();
					const e = new ArrayBuffer(16);
					const t = new Uint32Array(e);
					return (
						(t[0] = this.h0),
						(t[1] = this.h1),
						(t[2] = this.h2),
						(t[3] = this.h3),
						e
					);
				}),
				(Md5.prototype.buffer = Md5.prototype.arrayBuffer),
				(Md5.prototype.base64 = function () {
					for (let e, t, n, r = "", o = this.array(), i = 0; i < 15; ) {
						(e = o[i++]),
							(t = o[i++]),
							(n = o[i++]),
							(r +=
								base64EncodeChar[e >>> 2] +
								base64EncodeChar[63 & ((e << 4) | (t >>> 4))] +
								base64EncodeChar[63 & ((t << 2) | (n >>> 6))] +
								base64EncodeChar[63 & n]);
					}
					return `${r}${base64EncodeChar[(e = o[i]) >>> 2] + base64EncodeChar[(e << 4) & 63]}==`;
				});
			const exports = createMethod();
			commonJs ? (module.exports = exports) : (root.md5 = exports);
		})();
	});
	const collectDeviceData = (e, t) => {
		try {
			let n;
			let r;
			let o;
			let i;
			let s;
			let a;
			let c;
			let d;
			(r = (n = e || {}).sessionId), (o = n.accountId);
			const u = getTimeZone();
			(s = (i = window.screen || {}).height),
				(a = i.width),
				(c = i.pixelDepth),
				(d = i.orientation?.type);
			const l = getPlugins();
			const h = l ? md5(l) : "";
			const f = {
				time_zone: u,
				language: navigator.language,
				plugins_hash: h,
				screen_resolution: { h: s, w: a, pd: c, ot: d },
			};
			return (
				sendEvent("device_data", f, { sessionId: r, accountId: o }, t),
				Promise.resolve()
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	function getTimeZone() {
		let e = "";
		try {
			e = new Date().toString().match(/([-\+][0-9]+)\s/)[1];
		} catch (e) {}
		return e;
	}
	function getPlugins() {
		let e = "";
		try {
			for (let t = navigator.plugins || [], n = 0; n < t.length; n++) {
				e += n === t.length - 1 ? t[n].name : `${t[n].name},`;
			}
		} catch (e) {}
		return e;
	}
	function _catch(e, t) {
		try {
			const n = e();
		} catch (e) {
			return t(e);
		}
		return n?.then ? n.then(void 0, t) : n;
	}
	const createSession = (e) => {
		try {
			let t;
			let n;
			let r;
			let o;
			let i;
			let s;
			let a;
			const c = e.accountId;
			const d = e.trackerData;
			const u = e.baseUrlParams;
			return (
				(n = void 0 === (t = d.action_type) ? "" : t),
				(o = void 0 === (r = d.source_url) ? "" : r),
				(s = void 0 === (i = d.referrer_urls) ? [] : i),
				Promise.resolve(
					_catch(
						() =>
							Promise.resolve(
								makeEventRequest(
									"/session",
									{
										account_id: c,
										action_type: n,
										source_url: btoa(o),
										referrer_urls: btoa(
											JSON.stringify(
												Array.from(location.ancestorOrigins || []).concat(s),
											),
										),
									},
									u,
								),
							).then((e) => ((a = e) == null ? void 0 : a.session)),
						(e) => {
							logger1.uploadError({
								message: e.message,
								stack: e.stack,
								serviceName: serviceNameHash[n] || "ZPay JS",
								level: "high",
							});
						},
					),
				)
			);
		} catch (e) {
			return Promise.reject(e);
		}
	};
	const serviceNameHash = {
		sign_up: "Onboarding Widget",
		transaction: "Charge Widget",
		merchant_document_upload: "Settings Widget",
		bank_account_details_update: "Settings Widget",
	};
	const EventManager = (() => {
		function e(e) {
			const t = e.trackerData;
			const n = e.baseUrlParams;
			const r = void 0 === n ? {} : n;
			(this.accountId = e.accountId),
				(this.baseUrlParams = r),
				(this.trackerData = t),
				(this.sessionDetails = {
					sessionId: "",
				});
		}
		const t = e.prototype;
		return (
			(t.startDataCollection = (e) => {
				try {
					try {
						return Promise.resolve(
							createSession(e).then((t) => {
								void 0 === t && (t = {});
								try {
									return Promise.resolve(
										collectDeviceData(
											{
												sessionId: t.session_id,
												accountId: e.accountId,
											},
											e.baseUrlParams,
										),
									).then(() => t);
								} catch (e) {
									return Promise.reject(e);
								}
							}),
						);
					} catch (e) {
						logger1.error(
							"Error while creating a payments session : ",
							e.message || e,
						);
					}
					return Promise.resolve();
				} catch (e) {
					return Promise.reject(e);
				}
			}),
			(t.getSessionId = function () {
				try {
					let e;
					return (e = this.sessionDetails) != null && e.sessionId
						? Promise.resolve(this.sessionDetails.sessionId)
						: Promise.resolve(
								this.startDataCollection({
									accountId: this.accountId,
									trackerData: this?.trackerData,
									baseUrlParams: this.baseUrlParams,
								}),
							).then(
								(e) => (
									(this.sessionDetails.sessionId = e.session_id),
									e == null ? void 0 : e.session_id
								),
							);
				} catch (e) {
					return Promise.reject(e);
				}
			}),
			(t.sendBehaviourEvent = function (e) {
				sendEvent(
					e.eventType,
					e.data,
					{ sessionId: this.sessionDetails.sessionId },
					this.baseUrlParams,
				);
			}),
			e
		);
	})();
	const ZohoPayments = (() => {
		class E {
			constructor(e) {
				this.initOptions = e || {};
				const t = this.initOptions;
				const n = t._checkout;
				const r = void 0 === n || n;
				const o = t.accountId;
				const i = void 0 === o ? "" : o;
				const s = t.account_id;
				const a = void 0 === s ? "" : s;
				const c = t.frameorigin;
				const d = void 0 === c ? "" : c;
				const u = t.edition;
				const l = void 0 === u ? "" : u;
				const h = t.domain;
				const f = t.otherOptions;
				const _ = void 0 === f ? {} : f;
				const m = l || (void 0 === h ? "" : h);
				this.dom = new Dom();
				const v = getWidgetBaseURL(m, _ == null ? void 0 : _.__environment);
				r &&
					(this.charge = new ChargeWidget({
						domHandler: this.dom,
						accountId: i || a,
						frameorigin: d,
						otherOptions: _,
						baseUrl: v,
						edition: m,
					})),
					(this.onboarding = new Onboarding({
						domHandler: this.dom,
						frameorigin: d,
						baseUrl: v,
					})),
					(this.settings = new Settings({
						domHandler: this.dom,
						frameorigin: d,
						baseUrl: l && _.__environment && v,
					}));
			}
		}
		const t = E.prototype;
		return (
			(t.requestPaymentMethod = function () {
				let e;
				return (e = this.charge).requestPaymentMethod.apply(e, arguments);
			}),
			(t.collectBankAccounts = function () {
				let e;
				return (e = this.charge).collectBankAccounts.apply(e, arguments);
			}),
			(t.close = function () {
				let e;
				(e = this.charge).close.apply(e, arguments);
			}),
			(t.verifyPaymentMethod = function () {
				let e;
				return (e = this.charge).verifyPaymentMethod.apply(e, arguments);
			}),
			(t.destroy = () => {}),
			(t.getSessionId = function () {
				try {
					let e;
					const n = arguments;
					return (
						this.eventInstance ||
							(this.eventInstance = _construct(EventManager, n)),
						Promise.resolve(
							(e = this.eventInstance) == null ? void 0 : e.getSessionId(),
						)
					);
				} catch (e) {
					return Promise.reject(e);
				}
			}),
			E
		);
	})();
	return ZohoPayments;
}

export { zpayments };
